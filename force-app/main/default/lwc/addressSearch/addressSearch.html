<template>

    <template if:true={isLoading}>
        <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
    </template>
    
    <template if:false={addressSelected}>

        <lightning-input 
            type="text" 
            placeholder="Search for Address"
            label="Address"
            onchange={handleSearchChange}
        ></lightning-input>
        
        <template if:true={results.length}>
            <div id="listbox-id-2" class="list-container slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox">
                <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                    
                    <template for:each={results} for:item="r">
                        <li key={r.place_id} role="presentation" class="slds-listbox__item">
                            <div data-id={r.place_id} onclick={handleAddressSelect} class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta" role="option">
                                <span class="slds-media__figure slds-listbox__option-icon">
                                    <lightning-icon icon-name="standard:address" alternative-text="Address" title="Address"></lightning-icon>
                                </span>
                                <span class="slds-media__body">
                                    <span class="slds-listbox__option-text slds-listbox__option-text_entity">{r.structured_formatting.main_text}</span>
                                    <span class="slds-listbox__option-meta slds-listbox__option-meta_entity">{r.structured_formatting.secondary_text}</span>
                                </span>
                            </div>
                        </li>
                    </template>
                    
                </ul>
            </div>
        </template>

    </template>

    <template if:true={addressSelected}>
        <div class="slds-form-element">
            <label class="slds-form-element__label" for="combobox-id-5" id="combobox-label-id-33">Address</label>
                <div class="slds-form-element__control">
                    <div class="slds-combobox_container slds-has-selection">
                        <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click">
                            <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_left-right" role="none">
                                <span class="slds-icon_container slds-icon-standard-address slds-combobox__input-entity-icon" title="Address">
                                    <lightning-icon icon-name="standard:address" alternative-text="Address" title="Address"></lightning-icon>
                                    <span class="slds-assistive-text">Address</span>
                                </span>
                                <button type="button" class="slds-input_faux slds-combobox__input slds-combobox__input-value" aria-labelledby="combobox-label-id-33 combobox-id-5-selected-value" id="combobox-id-5-selected-value" aria-controls="listbox-id-5" aria-expanded="false" aria-haspopup="listbox">
                                    <span class="slds-truncate" id="combobox-value-id-20">{address.name}</span>
                                </button>
                                <button onclick={removeAddress} class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" title="Remove selected option">
                                    <lightning-icon icon-name="utility:close" alternative-text="close" title="close"></lightning-icon>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </template>

</template>